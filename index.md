
# コンタクト

* Twitter: [獏星(ばくすたー)@baku_dreameater](https://twitter.com/baku_dreameater)

# VMagicMirror マニュアル

目次

* 1: キャラクターを読み込んで動かす
* 2: ウィンドウ
* Tips 1: 表示位置を固定するには
* 3: レイアウトとキャラクターの動き
* 4: ライト
* 5: 終了時とおなじ設定で起動するには
* Tips 2: デスクトップマスコット化のための設定
* Tips 3: プレゼンでVMagicMirrorを使う
* 6: トラブルシューティング


## 1: キャラクターを読み込んで動かす

`VMagicMirror.exe`を起動すると、小さな設定ウィンドウと大きなキャラクター表示ウィンドウが表示されます。

![Start Image](https://github.com/malaybaku/VMagicMirror/blob/master/doc/pic/started.png)

設定ウィンドウの「VRMロード」ボタンを押し、PC上の`.vrm`ファイルを選択します。

選択すると、キャラクター表示ウィンドウに規約などが表示されるため、確認して問題なければ`OK`をクリックします。

キャラクターが表示され、マウスやキーボードの操作に応じて動くようになります。


## 2: ウィンドウ

クロマキーを変更したい場合やウィンドウを透明にしたい場合、「ウィンドウ」メニューの設定を変更します。

背景色を透明にしたり、キャラクターを常に最前面に表示することが出来ます。

## Tips 1: 表示位置を固定するには

キャラクターをいつも特定の位置に表示したい場合、次のようにします。

* 「起動時に特定の位置へウィンドウを動かす」をオンにします。
* 背景を透明にしている場合は、「(背景透明時)キャラ付近を掴んでドラッグ移動」をオンにします。
* キャラクターを好きな位置に動かして、「いまのウィンドウ位置を記憶」をクリックします。
* 画面内の「この設定を次の起動時にも適用」がチェックされていることを確認します。

設定した位置から基本的にキャラクターを動かしたくない場合、「(背景透明時)キャラ付近を掴んでドラッグ移動」をオフにします。


## 3: レイアウトとキャラクターの動き

キャラクターの動き方、カメラや入力デバイスの配置を`レイアウト`タブから変更できます。

### 3.1. キャラクターの動き

キャラクターの動きは4つのセクションで設定できます。

* `手の動き`
* `腕の動き`
* `待機時のモーション`
* `その他のモーション`

`手の動き`ではキャラクターの手の形や、手の上下の動き方を指定します。タイピング中の手の位置がおかしい場合や手がキーボードから浮いて見える場合、調整してみてください。

`腕の動き`では、キャラクターの脇を締める動きや、右腕をプレゼンテーションライクに動かす「プレゼンモード」を設定できます。

`待機時のモーション`は呼吸動作に相当する動きです。キャラクターによっては、動きを極端に大きくすると浮いて見えるかもしれません。

`その他のモーション`ではキャラクターが視線を向ける方向を変更できるほか、入力マイクを指定することでリップシンクを有効にできます。


### 3.2. カメラ

カメラの位置を設定します。

カメラの位置は、パラメータで設定して正面からの見た目にできるほか、フリーカメラモードで自由に決めることもできます。

パラメータについては`高さ`、`キャラとの距離`、`角度`をそれぞれ動かし、見た目がどのように変わるか確認してみてください。

キャラクターを斜め前から眺めたいなど、自由にカメラ位置を決めたいときは次のようにします。

* 「カスタムカメラ位置を使用」のチェックを有効化
* もし背景が透明な場合、いったん`ウィンドウ`のタブを開き、`背景を透明にする`をオフ
* 「フリーカメラモード」のチェックをオン
* キャラクター表示ウィンドウをクリックしたのち、マウスで視点を移動
    + 中クリック+ドラッグ: 視点を上下左右に並行移動
    + 右クリック+ドラッグ: 視点を回転
    + ホイール: 視点を前後に移動
* 「フリーカメラモード」をオフ
* 背景を透明に戻す場合、ふたたび`ウィンドウ`タブを開き、`背景を透明にする`をオン


### 3.3. キーボード・マウスパッド

キーボードやマウスパッドの大きさ、高さを変更できます。キャラクターの体格に応じてサイズを変更してください。

初期状態ではキーボード、マウスパッドの位置に相当する場所にメッシュが表示されていますが、オフにすると表示しなくなります。

### 3.4. ゲームパッド

ゲームパッドを使う場合、`ゲームパッド入力のキャプチャを有効化`をオンにします。

`3.3. キーボード・マウスパッド`と同じく、ゲームパッドの高さや大きさが設定できます。

また、ジョイパッドのスティックを傾けるとキャラクターも傾きます。試しにデフォルト設定のまま、左スティックを動かしてみて下さい。

* `キャラ傾き入力`でキャラクターが傾くスティックの種類を変更できます。
* `傾く方向を反転`のチェックをオンにすると、スティック入力と逆方向にキャラクターが傾きます。


## 4: ライトの設定

光の色や強弱を調整するには、設定ウィンドウの「ライト」をクリックします。ライトに加えてBloomの色や強さも調整できます。


## 5: 終了時とおなじ設定で起動するには

同じ設定で次回にVMagicMirrorを起動したい場合、「スタートアップ」をクリックし、4つの項目のチェックをオンにします。

## Tips 2: デスクトップマスコット化のための設定

VMagicMirrorをデスクトップマスコット化するには次のようにします。

### Tips 2(前半). VMagicMirrorのセットアップ

* `1: キャラクターを読み込んで動かす`の手順にしたがって、VRMを読み込みます。
* ウィンドウタブを開き、「背景を透明にする」をオンにします。
* `Tips 1: 表示位置を固定するには`の手順にしたがって、キャラクターの表示位置を固定します。
* ホームタブを開き、「次回の起動時にも同じVRMを読み込む」をオンにします。
* そのほか、レイアウトやライトの設定を変更している場合、スタートアップタブを開き、各項目のチェックをオンにします。

以上の設定を行ったのち、いったんVMagicMirrorを終了して再度起動すると動作が確認できます。


### Tips 2(後半). Windowsの起動時にVMagicMirrorをスタートするには

Windowsを起動した直後に自動でVMagicMirrorをスタートするには以下のようにします。

* `VmagicMirror.exe`を右クリックし、ショートカットを作成します。
* Windowsのスタートアップフォルダの中へショートカットを移動します。

スタートアップフォルダのパスは以下の通りです。ユーザー名の部分は実際のユーザー名で置き換えてください。

`C:\Users\(ユーザー名)\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`

異なるバージョンのVMagicMirrorで置き換える場合やWindows起動時のVMagicMirror起動を防ぎたい場合、ショートカットを削除します。


## Tips 3: プレゼンでVMagicMirrorを使う

v0.16から追加された「プレゼンモード」を用いると、プレゼンテーションでVMagicMirrorを使うことが出来ます。

プレゼンモードは、右手をマウスポインタがある方向に指す機能です。

使いこなすことで、キャラクターがプレゼンテーションしているように見せることが出来ます。

次の2ステップでプレゼンモードを利用します。

* Step 1: スライドのレイアウトがキャラクター表示に適しているか確認します。
* Step 2: VMagicMirrorをプレゼンモード向けにセットアップします。
* Step 3: 実際にプレゼンテーションを行います。

### Tips 3. Step 1: スライドのレイアウトチェック

スライドの右下の領域を空白にして、キャラクターの表示スペースを確保します。

単なる空白の代わりに、キャラクターの背景となるワイプ窓や部屋の模様を配置することも有効かもしれません。

スライドの右上については、以下のいずれかにすることをお勧めします。

* 補足の小さなテキスト
* キャラクターから出ているように見えるフキダシ
* キャラクターのリアクションに見える漫符

### Tips 3. Step 2: VMagicMirrorのセットアップ 

* `1: キャラクターを読み込んで動かす`の手順にしたがって、VRMを読み込みます。

* `レイアウト`タブを開き、`キャラクターの動き`にある`腕の動き`項目を開きます。
* `プレゼンモード`をオンにし、マウスを動かして動きを確認します。
    + 右腕の動きが大きすぎる、または小さすぎる場合は`プレゼン動作の大きさ`を調整します。
    + 右手が体にめり込みやすい場合は`プレゼン動作の手の最小半径`を大きくします。
    + `プレゼン動作の大きさ`を小さくしても腕が伸びっぱなしになる場合は`プレゼン動作の手の最小半径`を小さくします。

* キャラクターの向きを調整したい場合、`3.2. カメラ`の設定を参考に、カメラ位置を調整します。
    + サイズが全く合わない場合は、ソフト起動時の解像度を引き上げるとキャラクターが大きくなります。
* `ウィンドウ`タブを開き、`キャラクターをつねに最前面で表示`および`背景を透明にする`をオンにします。
* 同じく`ウィンドウ`タブの`(背景透明時)キャラ付近を掴んでドラッグ移動`をオンにし、キャラクターをプレゼン中に表示したい位置まで移動します。
* 位置の調整が終わったら、`(背景透明時)キャラ付近を掴んでドラッグ移動`をオフにします。
    + ※チェックがオンになったままだと、キャラクターが邪魔になってスライドが触れなくなる事があります。

以上で準備は完了し、プレゼンの準備が整いました。

この時点で見栄えに満足が行っていない場合、ライトやレイアウトの設定を確認してください。

### Tips 3. Step 3: プレゼンテーション

プレゼンテーションを行いながらマウスを動かすことで、キャラクターがスライドをさしているように演出します。

Microsoft PowerPointの場合、スライド上で右クリックし、





## 6: トラブルシューティング

* マウスを動かしているのにキャラクターが動かなくなった場合、キャラクター表示ウィンドウをクリックしてみて下さい。
* キャラクターの付近にある設定ウィンドウや他のウィンドウがクリックできない場合、キャラクターの透過部分をクリックしてしまっている可能性があります。この場合、キャラクターを一時的に上下に移動してください。また、キャラクターを動かしたいのでなければ、`ウィンドウ`タブの`(背景透明時)キャラ付近を掴んでドラッグ移動`をオフにします。
* 起動直後にアプリケーションが停止してしまう場合、`VMagicMirror.exe`があるフォルダに存在する`ConfigApp`フォルダを開いて以下のファイルを削除し、その後に`VMagicMirror`を再度起動してください。
    + `_currentBackground`
    + `_currentLayout`
    + `_currentLight`
    + `_currentVrm`
    + `_startup`

